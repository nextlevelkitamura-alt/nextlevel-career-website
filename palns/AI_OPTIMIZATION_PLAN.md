# AI Job Data Optimization Plan

## 1. 目的・ゴール
ユーザー（求職者）に最適な求人を提案（レコメンド）するために、求人データの「質」をAIの力で向上させます。
具体的には、**「非構造化データ（テキスト）」を「構造化データ（タグ・パラメータ）」に変換**し、検索・マッチング精度を高めます。

## 2. Gemini 3.0 の活用
Gemini 3.0（`gemini-3-pro-preview` / `gemini-3-flash-preview`）の高い推論能力を活用し、求人票の曖昧な表現からも正確な条件を抽出します。

### 設定情報
- **Model**: `gemini-3-pro-preview` (または `gemini-3-flash-preview` でコスト最適化)
- **Library**: `@google/generative-ai`

## 3. 実装計画：AI求人解析パイプライン

求人登録時（または一括更新時）に、以下のフローでデータをリッチ化します。

### Step 1: 入力データ (Raw Text)
求人票の「仕事内容」「応募資格」「勤務時間」「福利厚生」などのテキストをAIに入力します。

### Step 2: AIによる構造化・グルーピング (Processing)
AIに以下の指示を与え、JSON形式で出力させます。

**指示プロンプト例：**
> あなたはプロのキャリアアドバイザーです。以下の求人情報を分析し、検索システム最適化のためのタグとパラメータを抽出してください。
> 特に「休日」「給与」「残業」に関しては、求職者が検索しやすいように以下の定義で分類してください。

### Step 3: 出力データ (Structured Data)
以下のようなパラメータをデータベース（`jobs` テーブル）に追加・更新します。

#### A. 基本グルーピングタグ (`tags` 配列)
細かい条件を以下の大カテゴリに分類してタグ付けします。

| カテゴリ | タグ例 (AIが自動付与) |
| :--- | :--- |
| **働き方** | `残業なし`, `リモート可`, `フレックス`, `時短勤務` |
| **休日** | `土日祝休み`, `年間休日120日以上`, `完全週休2日` |
| **金銭条件** | `賞与あり`, `インセンティブあり`, `交通費全額支給`, `高収入` |
| **環境・風土** | `未経験歓迎`, `研修充実`, `女性管理職登用`, `若手活躍中` |
| **緊急度** | `急募`, `大量募集` |

#### B. マッチング用パラメータ (診断機能との連携用)
適職診断（4タイプ）との連携を強化するため、以下のスコア（0〜100）を算出させることも検討します。
*   `score_stability` (安定性 - タイプA向け)
*   `score_private` (プライベート重視 - タイプB向け)
*   `score_income` (収益性 - タイプC向け)
*   `score_speed` (即戦力/スピード - タイプD向け)

## 4. データベース改修案
`jobs` テーブルに `ai_analysis` (JSONB) カラム、または `search_tags` (Array) カラムを拡張することを推奨します。

```typescript
type JobAIAnalysis = {
  // 自動生成タグ
  generated_tags: string[];
  // 診断タイプ適合度 (例)
  type_suitability: {
    A: number; // コツコツ
    B: number; // プライベート
    C: number; // ガツガツ
    D: number; // スピード
  };
  // 構造化データ
  salary_min: number;
  salary_max: number;
  holiday_count: number;
};
```

## 5. 次のアクション
1.  **AIユーティリティの作成**: `utils/gemini.ts` を作成し、Gemini 3.0 への接続を確立。
2.  **プロンプトの設計**: テスト用求人データを使って、意図通りのタグが出力されるかテスト。
3.  **データ更新**: 既存の求人データに対してスクリプトを実行し、タグを付与。

この計画で、**「求人が提案されない（マッチしない）」** という問題を、**「AIが数、種類、適合度を深く理解して提案する」** 形へ解消します。
